(()=>{"use strict";var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=require("dxt-js");var r=t.n(e);const i=require("image-pixels");var n=t.n(i);const a=require("buffer"),o=require("@citizenfx/http-wrapper"),s=require("koa"),c=new(t.n(s)());c.use((async t=>{const e=t.request.query.path||"http://media.istockphoto.com/photos/seamless-texture-surface-of-the-moon-picture-id108604226";t.set("Content-disposition","attachment; filename=myfile.dds"),t.set("Content-type","image/vnd-ms.dds"),t.body=await(async t=>{const{data:e,width:i,height:o}=await n()(t),s=Math.floor((i*o*4+7)/8);let c=0;const l=a.Buffer.alloc(128);l.write("DDS ",4*c++,"ascii"),l.writeUInt32LE(124,4*c++),l.writeUInt32LE(528391,4*c++),l.writeUInt32LE(o,4*c++),l.writeUInt32LE(i,4*c++),l.writeUInt32LE(s,4*c++),l.writeUInt32LE(0,4*c++),l.writeUInt32LE(1,4*c++);for(let t=0;t<11;t++)l.writeUInt32LE(0,4*c++);l.writeUInt32LE(32,4*c++),l.writeUInt32LE(5,4*c++),l.write("DXT1",4*c++,"ascii"),l.writeUInt32LE(32,4*c++),l.writeUInt32LE(4278190080,4*c++),l.writeUInt32LE(16711680,4*c++),l.writeUInt32LE(65280,4*c++),l.writeUInt32LE(255,4*c++),l.writeUInt32LE(4096,4*c++);const u=r().flags.DXT1|r().flags.ColourIterativeClusterFit|r().flags.ColourMetricPerceptual,w=r().compress(e,i,o,u);return a.Buffer.concat([l,a.Buffer.from(w)])})(e)})),(0,o.setHttpCallback)(c.callback())})();